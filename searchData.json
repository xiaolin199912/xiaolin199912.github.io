[{"title":"焕影一新v1.1.0","url":"/2021/05/23/焕影一新v1.1.0/","content":"\n**![1](https://linimages.oss-cn-beijing.aliyuncs.com/typora/header_image2.png)**\n\n大家好\n\n这里是p图助力官小林\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/doge.webp\" alt=\"doge\" height=100 />\n\n历时一个月\n\n我们发布了超大版本**v1.1.0**\n\n来看看新版本更新了哪些内容吧\n\n\n\n## 新功能:「动态照片」\n\n让静态的照片根据你的想法动起来\n\n听上去是不是有些不可思议？\n\n在「动态照片」里就能让它变成现实\n\n「动态照片」支持选定照片中的**人脸**与驱动它的**模版**\n\n让它做出模版对应的表情\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/02.webp\" alt=\"img\" height=\"300\" />\n\n我们提供的8种模版\n\n比如我们让玛丽莲·梦露唱《Bad Guy》\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/03.gif\" alt=\"img\" height=\"300\" />\n\n两代天后的借助AI技术实现梦幻联动\n\n工具和照片已经在你手里\n\n你能用它整蛊创作出什么样的视频呢？\n\n\n\n## 2.1 功能升级 ——「照片修复」\n\n之前的算法对异常模糊的老照片有好的修复效果\n\n但是对大家日常的自拍/他拍来说\n\n效果却有些差强人意\n\n![04](https://linimages.oss-cn-beijing.aliyuncs.com/typora/04.webp)\n\n这次更新我们全新升级了「照片修复」算法\n\n**希望在清晰的基础上，让照片更自然好看**\n\n这对日常照片有更好的修复效果\n\n一组修复前后对比\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/05.webp\" alt=\"img\" height=\"400\" />\n\n细节对比\n\n![img](https://linimages.oss-cn-beijing.aliyuncs.com/typora/06.webp)\n\n为了女生更漂亮的照片\n\n我们拼了orz\n\n\n\n## 2.2 功能升级——「证件照换底」\n\n曾有妹子向小林吐槽\n\n**“你们的边缘抠的不太理想”**\n\n**“最后我还是打车去了照相馆”**\n\n**“店家PS操作一会儿就换好了”**\n\n场面一度十分尴尬\n\n**“但是他居然一个底色就要了10块钱，呜呜呜”**\n\n算上车费，妹子哭的更大声了\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/07.webp\" alt=\"img\" height=\"200\" />\n\n虽然证件照换底色对于PS熟手来说不是难事\n\n但是对于我们这些小白来说\n\n高昂的学习成本就已经劝退成功\n\n所以只好乖乖让商家割韭菜\n\n\n\n**本次更新中，证件照换底的人像抠图效果**\n\n**得到了指数级提升**\n\n头发,人脸,服装的边缘抠图效果都得到了优化\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/08.webp\" alt=\"img\" height=\"250\" />\n\n目前支持**红、白、蓝**三色换底\n\n后续将更新更多的底色供大家选择\n\n以及呼声很高的**一键换西服**功能\n\n\n\n## 3.UI全面升级\n\n本次更新焕影一新的所有界面\n\n都套上了新皮肤\n\n<img src=\"https://linimages.oss-cn-beijing.aliyuncs.com/typora/09.webp\" alt=\"09\" height=\"300\" />\n\n部分UI\n\n\n\n## 4.其他更新\n\n新增可对比式照片分享\n\n新增每日额度/任务额度机制\n\n升级「智能抠图」界面\n\n修复「意见反馈」bug\n\n新增后端接口监控服务\n\n部分文案优化\n\n\n\n## 写在最后\n\n焕影一新从零开发到今天遇到了很多困难\n\n我们也从一个菜鸟学生团队\n\n一点点走向专业\n\nv1.1.0版本是我们的第一个base版本\n\n算是个小小的里程碑\n\n感谢大家一直以来的支持\n\n我们会继续迭代好它\n\n做一款不简单的AI影像应用\n\n\n\n## 开发人员\n\n- 产品:小林\n\n- Web开发:意识流、炎魔の王、Nexisato\n\n- 算法研发:小林、Cuny\n\n- 美术运营:凯撒、振闻","tags":["产品，机器学习"]},{"title":"Gradio：轻松实现AI算法可视化部署","url":"/2021/05/21/Gradio：轻松实现AI算法可视化部署/","content":"\n**![1](https://inkfishing.oss-cn-hangzhou.aliyuncs.com/blogs/header_image2.png)**\n\n**如何将你的AI算法迅速分享给别人，让对方体验，一直是一件麻烦事儿。**\n\n首先大部分人都是在本地跑代码，让别人使用你的模型，以往有这三种方案：\n\n- 上github\n- 将代码打包或者封装成docker后，用QQ/百度云/U盘传输\n- 学习前后端知识，写个前端界面，买个域名，用flask这样微服务框架快速部署，看情况结合一下内网穿透。\n\n这些方案的问题在于——前两者需要对方会编程会配置环境（还得愿意），**我们的分享对象满足这个条件的寥寥无几**；后者则需要你这个算法工程师升级成全栈，学习前后端开发，**学习成本太高**。\n\n总结起来：**场景不匹配，需求不契合，费时又费力！**\n\n那么有没有更好的解决方案呢？有！它就是我今天要给大家安利的一个python开源库：**Gradio**。\n\n​\t![image-20210521152614971](https://inkfishing.oss-cn-hangzhou.aliyuncs.com/blogs/01/0101.png)\n\nGradio是MIT的开源项目，GitHub 2k+ star。\n\n使用gradio，只需在原有的代码中**增加几行**，就能自动化生成交互式web页面，并支持多种输入输出格式，比如图像分类中的图>>标签，超分辨率中的图>>图等。\n\n同时还支持生成能外部网络访问的链接，**能够迅速让你的朋友，同事体验你的算法**。\n\n总结起来，它的优势有：\n\n- 自动生成页面且**可交互**\n- 改动**几行代码**就能完成\n- 支持自定义多种输入输出\n- 支持生成**可外部访问的链接**进行分享\n\n目前已经有很多优秀的开源项目使用Gradio做demo页面。那么该怎么使用Gradio，让我们一起来玩玩～\n\n\n\n## Get start\n\n### 0.安装Gradio\n\n```bash\npip install gradio\n```\n\n### 1.写个简单的RGB转灰度\n\n```python\nimport gradio as gr\nimport cv2\n\ndef to_black(image):\n    output = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n    return output\n\ninterface = gr.Interface(fn=to_black, inputs=\"image\", outputs=\"image\")\ninterface.launch()\n```\n\ngradio的核心是它的`gr.Interface`函数，用来构建可视化界面。\n\n- fn：放你用来处理的函数\n- inputs：写你的输入类型，这里输入的是图像，所以是\"image\"\n- outputs：写你的输出类型，这里输出的是图像，所以是\"image\"\n\n最后我们用`interface.lauch()`把页面一发布，一个本地静态交互页面就完成了！\n\n在浏览器输入`http://127.0.0.1:7860/`,查收你的页面：\n\n![image-20210521152336959](https://inkfishing.oss-cn-hangzhou.aliyuncs.com/blogs/01/0102.png)\n\n上传一张图片，点击「SUBMIT」，大功告成。\n\n![image-20210521152500026](https://inkfishing.oss-cn-hangzhou.aliyuncs.com/blogs/01/0103.png)\n\n对于任何图像处理类的ML代码来说，只要定义好一个图像输入>>模型推理>>返回图片的函数（逻辑和RGB转灰度图本质上没区别），放到`fn`中，就完事了。\n\n​\t\n\n### 2.增加example\n\n我们可以在页面下方添加供用户选择的测试样例。\n\n在`gr.Interface`里的`examples`中放入图片路径，格式为[[路径1],[路径2],...]。\n\n```python\nimport gradio as gr\nimport cv2\n\ndef to_black(image):\n    output = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n    return output\n\ninterface = gr.Interface(fn=to_black, inputs=\"image\", outputs=\"image\",\n                        examples=[[\"test.png\"]])\ninterface.launch()\n```\n\n![image-20210521155634673](https://inkfishing.oss-cn-hangzhou.aliyuncs.com/blogs/01/0104.png)\n\n增加example不仅能让你的UI界面更美观，逻辑更完善，也有一些其他意义：\n\n- 比如做了一个图像去噪算法，但是用户手头并没有躁点照片，example能让他更快的体验到效果\n\n当然example建议选择效果最好的图，原因和写论文选best case一样（大雾）。\n\n## 3.创建一个外部访问链接\n\n创建外部访问链接非常简单，只需要`launch(share=True)`即可，在打印信息中会看到你的外部访问链接。\n\n免费用户的链接可以使用24小时，想要长期的话需要在gradio官方购买云服务。\n\n\n\n## 4.升个级:图像分类pytorch+resnet18\n\n```python\nimport gradio as gr\nimport torch\nfrom torchvision import transforms\nimport requests\nfrom PIL import Image\n\nmodel = torch.hub.load('pytorch/vision:v0.6.0', 'resnet18', pretrained=True).eval()\n\n# Download human-readable labels for ImageNet.\nresponse = requests.get(\"https://git.io/JJkYN\")\nlabels = response.text.split(\"\\n\")\n\ndef predict(inp):\n  inp = Image.fromarray(inp.astype('uint8'), 'RGB')\n  inp = transforms.ToTensor()(inp).unsqueeze(0)\n  with torch.no_grad():\n    prediction = torch.nn.functional.softmax(model(inp)[0], dim=0)\n  return {labels[i]: float(prediction[i]) for i in range(1000)}\n\ninputs = gr.inputs.Image()\noutputs = gr.outputs.Label(num_top_classes=3)\ngr.Interface(fn=predict, inputs=inputs, outputs=outputs).launch()\n```\n\n![image-20210521160432207](https://inkfishing.oss-cn-hangzhou.aliyuncs.com/blogs/01/0105.png)\n\n图像分类任务是机器学习经典任务。上面我们在outputs中设置了`gr.outputs.Label(num_top_classes=3)`，这是Gradio中专为图像分类**展示类标**定制的函数.\n\n**修改inputs和outputs的组合，总能找到适合你的算法的那一个。**\n\nps:不得不说imagenet的类标真细\n\n\n\n## 总结\n\nGradio的最大的价值我认为是缩短了算法与应用的距离，人人都能迅速分享与体验项目成果，这不管在同事交流，项目汇报，甚至是同学吹牛（大雾），都性感多了。\n\n同时，作为一个python库，不论是ML，还是数据分析，图像处理，甚至做一个视频转gif的小工具（自媒体老哥表示很有用），都能适用。\n\n**你还在发愁怎么做大作业PPT汇报吗？不如试试Gradio。**\n\n\n\n## 了解更多\n\n- Gradio官网：https://www.gradio.app/\n- Gradio官方文档：https://gradio.app/docs\n\n- 使用Gradio的项目「Anime2Sketch」：https://www.gradio.app/hub/AK391/Anime2Sketch\n\n","tags":["机器学习"]}]